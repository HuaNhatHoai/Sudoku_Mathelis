<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¢u ƒê·ªë Einstein - 5 Ng√¥i Nh√†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .house {
            transition: all 0.3s ease;
        }
        .house:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .draggable {
            cursor: grab;
            transition: all 0.2s ease;
        }
        .draggable:hover {
            transform: scale(1.05);
        }
        .draggable.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }
        .drop-zone {
            min-height: 40px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            transition: all 0.2s ease;
        }
        .drop-zone.drag-over {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .clue {
            transition: all 0.3s ease;
        }
        .clue:hover {
            background-color: #f1f5f9;
            transform: translateX(5px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Login Screen -->
        <div id="loginScreen" class="text-center">
            <div class="bg-white rounded-lg shadow-xl p-8 max-w-md mx-auto">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">üè† C√¢u ƒë·ªë Einstein-Mathelis</h1>
                <p class="text-lg text-gray-600 mb-1">Mathletica: ƒê·ªë vui kh√¥ng th∆∞·ªüng #2</p>
                <p class="text-sm text-gray-500 mb-6">K√©o th·∫£ c√°c thu·ªôc t√≠nh v√†o ƒë√∫ng ng√¥i nh√† ƒë·ªÉ gi·∫£i c√¢u ƒë·ªë!</p>
                
                <div class="mb-6">
                    <label for="playerName" class="block text-sm font-medium text-gray-700 mb-2">Nh·∫≠p t√™n c·ªßa b·∫°n:</label>
                    <input type="text" id="playerName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="T√™n c·ªßa b·∫°n...">
                </div>
                
                <button id="startGame" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                    üöÄ B·∫Øt ƒë·∫ßu ch∆°i
                </button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="hidden">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">üè† C√¢u ƒë·ªë Einstein-Mathelis</h1>
                <p class="text-lg text-gray-600">Mathletica: ƒê·ªë vui kh√¥ng th∆∞·ªüng #2</p>
                <p class="text-sm text-gray-500 mt-1">Ch√†o <span id="playerNameDisplay" class="font-semibold text-blue-600"></span>! K√©o th·∫£ c√°c thu·ªôc t√≠nh v√†o ƒë√∫ng ng√¥i nh√† ƒë·ªÉ gi·∫£i c√¢u ƒë·ªë!</p>
                <div class="mt-4 bg-white rounded-lg shadow p-4 inline-block">
                    <div class="text-lg font-semibold text-gray-700">‚è±Ô∏è Th·ªùi gian: <span id="timer" class="text-blue-600">00:00</span></div>
                </div>
            </div>

        <!-- Houses -->
        <div class="grid grid-cols-5 gap-4 mb-8">
            <div class="house bg-yellow-100 rounded-lg shadow-lg p-4 border-4 border-yellow-400" data-house="V√†ng">
                <div class="text-center mb-3">
                    <div class="text-3xl mb-1">
                        <svg width="32" height="32" viewBox="0 0 32 32" class="mx-auto">
                            <rect x="4" y="12" width="24" height="16" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                            <polygon points="2,12 16,2 30,12" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                            <rect x="10" y="18" width="4" height="10" fill="#f59e0b"/>
                            <rect x="18" y="16" width="6" height="6" fill="#fde68a" stroke="#f59e0b"/>
                        </svg>
                    </div>
                    <div class="font-bold text-yellow-800">Nh√† V√†ng</div>
                </div>
                <div class="space-y-2">
                    <div class="drop-zone" data-type="nationality" data-house="V√†ng">
                        <div class="text-xs text-yellow-700 p-1 font-medium">Qu·ªëc t·ªãch</div>
                    </div>
                    <div class="drop-zone" data-type="pet" data-house="V√†ng">
                        <div class="text-xs text-yellow-700 p-1 font-medium">Th√∫ c∆∞ng</div>
                    </div>
                    <div class="drop-zone" data-type="drink" data-house="V√†ng">
                        <div class="text-xs text-yellow-700 p-1 font-medium">ƒê·ªì u·ªëng</div>
                    </div>
                    <div class="drop-zone" data-type="job" data-house="V√†ng">
                        <div class="text-xs text-yellow-700 p-1 font-medium">Ngh·ªÅ nghi·ªáp</div>
                    </div>
                </div>
            </div>

            <div class="house bg-blue-100 rounded-lg shadow-lg p-4 border-4 border-blue-400" data-house="Xanh d∆∞∆°ng">
                <div class="text-center mb-3">
                    <div class="text-3xl mb-1">
                        <svg width="32" height="32" viewBox="0 0 32 32" class="mx-auto">
                            <rect x="4" y="12" width="24" height="16" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
                            <polygon points="2,12 16,2 30,12" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
                            <rect x="10" y="18" width="4" height="10" fill="#3b82f6"/>
                            <rect x="18" y="16" width="6" height="6" fill="#93c5fd" stroke="#3b82f6"/>
                        </svg>
                    </div>
                    <div class="font-bold text-blue-800">Nh√† Xanh D∆∞∆°ng</div>
                </div>
                <div class="space-y-2">
                    <div class="drop-zone" data-type="nationality" data-house="Xanh d∆∞∆°ng">
                        <div class="text-xs text-blue-700 p-1 font-medium">Qu·ªëc t·ªãch</div>
                    </div>
                    <div class="drop-zone" data-type="pet" data-house="Xanh d∆∞∆°ng">
                        <div class="text-xs text-blue-700 p-1 font-medium">Th√∫ c∆∞ng</div>
                    </div>
                    <div class="drop-zone" data-type="drink" data-house="Xanh d∆∞∆°ng">
                        <div class="text-xs text-blue-700 p-1 font-medium">ƒê·ªì u·ªëng</div>
                    </div>
                    <div class="drop-zone" data-type="job" data-house="Xanh d∆∞∆°ng">
                        <div class="text-xs text-blue-700 p-1 font-medium">Ngh·ªÅ nghi·ªáp</div>
                    </div>
                </div>
            </div>

            <div class="house bg-red-100 rounded-lg shadow-lg p-4 border-4 border-red-400" data-house="ƒê·ªè">
                <div class="text-center mb-3">
                    <div class="text-3xl mb-1">
                        <svg width="32" height="32" viewBox="0 0 32 32" class="mx-auto">
                            <rect x="4" y="12" width="24" height="16" fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                            <polygon points="2,12 16,2 30,12" fill="#fecaca" stroke="#dc2626" stroke-width="2"/>
                            <rect x="10" y="18" width="4" height="10" fill="#dc2626"/>
                            <rect x="18" y="16" width="6" height="6" fill="#fca5a5" stroke="#dc2626"/>
                        </svg>
                    </div>
                    <div class="font-bold text-red-800">Nh√† ƒê·ªè</div>
                </div>
                <div class="space-y-2">
                    <div class="drop-zone" data-type="nationality" data-house="ƒê·ªè">
                        <div class="text-xs text-red-700 p-1 font-medium">Qu·ªëc t·ªãch</div>
                    </div>
                    <div class="drop-zone" data-type="pet" data-house="ƒê·ªè">
                        <div class="text-xs text-red-700 p-1 font-medium">Th√∫ c∆∞ng</div>
                    </div>
                    <div class="drop-zone" data-type="drink" data-house="ƒê·ªè">
                        <div class="text-xs text-red-700 p-1 font-medium">ƒê·ªì u·ªëng</div>
                    </div>
                    <div class="drop-zone" data-type="job" data-house="ƒê·ªè">
                        <div class="text-xs text-red-700 p-1 font-medium">Ngh·ªÅ nghi·ªáp</div>
                    </div>
                </div>
            </div>

            <div class="house bg-gray-100 rounded-lg shadow-lg p-4 border-4 border-gray-400" data-house="Tr·∫Øng">
                <div class="text-center mb-3">
                    <div class="text-3xl mb-1">
                        <svg width="32" height="32" viewBox="0 0 32 32" class="mx-auto">
                            <rect x="4" y="12" width="24" height="16" fill="#f8f9fa" stroke="#6b7280" stroke-width="2"/>
                            <polygon points="2,12 16,2 30,12" fill="#f8f9fa" stroke="#6b7280" stroke-width="2"/>
                            <rect x="10" y="18" width="4" height="10" fill="#6b7280"/>
                            <rect x="18" y="16" width="6" height="6" fill="#ddd6fe" stroke="#6b7280"/>
                        </svg>
                    </div>
                    <div class="font-bold text-gray-800">Nh√† Tr·∫Øng</div>
                </div>
                <div class="space-y-2">
                    <div class="drop-zone" data-type="nationality" data-house="Tr·∫Øng">
                        <div class="text-xs text-gray-700 p-1 font-medium">Qu·ªëc t·ªãch</div>
                    </div>
                    <div class="drop-zone" data-type="pet" data-house="Tr·∫Øng">
                        <div class="text-xs text-gray-700 p-1 font-medium">Th√∫ c∆∞ng</div>
                    </div>
                    <div class="drop-zone" data-type="drink" data-house="Tr·∫Øng">
                        <div class="text-xs text-gray-700 p-1 font-medium">ƒê·ªì u·ªëng</div>
                    </div>
                    <div class="drop-zone" data-type="job" data-house="Tr·∫Øng">
                        <div class="text-xs text-gray-700 p-1 font-medium">Ngh·ªÅ nghi·ªáp</div>
                    </div>
                </div>
            </div>

            <div class="house bg-green-100 rounded-lg shadow-lg p-4 border-4 border-green-400" data-house="Xanh l√°">
                <div class="text-center mb-3">
                    <div class="text-3xl mb-1">
                        <svg width="32" height="32" viewBox="0 0 32 32" class="mx-auto">
                            <rect x="4" y="12" width="24" height="16" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                            <polygon points="2,12 16,2 30,12" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
                            <rect x="10" y="18" width="4" height="10" fill="#16a34a"/>
                            <rect x="18" y="16" width="6" height="6" fill="#86efac" stroke="#16a34a"/>
                        </svg>
                    </div>
                    <div class="font-bold text-green-800">Nh√† Xanh L√°</div>
                </div>
                <div class="space-y-2">
                    <div class="drop-zone" data-type="nationality" data-house="Xanh l√°">
                        <div class="text-xs text-green-700 p-1 font-medium">Qu·ªëc t·ªãch</div>
                    </div>
                    <div class="drop-zone" data-type="pet" data-house="Xanh l√°">
                        <div class="text-xs text-green-700 p-1 font-medium">Th√∫ c∆∞ng</div>
                    </div>
                    <div class="drop-zone" data-type="drink" data-house="Xanh l√°">
                        <div class="text-xs text-green-700 p-1 font-medium">ƒê·ªì u·ªëng</div>
                    </div>
                    <div class="drop-zone" data-type="job" data-house="Xanh l√°">
                        <div class="text-xs text-green-700 p-1 font-medium">Ngh·ªÅ nghi·ªáp</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Draggable Items -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üéØ K√©o th·∫£ c√°c thu·ªôc t√≠nh</h3>
                
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Qu·ªëc t·ªãch:</h4>
                    <div class="flex flex-wrap gap-2">
                        <div class="draggable bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="nationality" data-value="Anh">üá¨üáß Anh</div>
                        <div class="draggable bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="nationality" data-value="T√¢y Ban Nha">üá™üá∏ T√¢y Ban Nha</div>
                        <div class="draggable bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="nationality" data-value="Ukraine">üá∫üá¶ Ukraine</div>
                        <div class="draggable bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="nationality" data-value="Na Uy">üá≥üá¥ Na Uy</div>
                        <div class="draggable bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="nationality" data-value="Nh·∫≠t">üáØüáµ Nh·∫≠t</div>
                    </div>
                </div>



                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Th√∫ c∆∞ng:</h4>
                    <div class="flex flex-wrap gap-2">
                        <div class="draggable bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="pet" data-value="Ch√≥">üêï Ch√≥</div>
                        <div class="draggable bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="pet" data-value="·ªêc s√™n">üêå ·ªêc s√™n</div>
                        <div class="draggable bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="pet" data-value="C√°o">ü¶ä C√°o</div>
                        <div class="draggable bg-brown-100 text-brown-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="pet" data-value="Ng·ª±a">üêé Ng·ª±a</div>
                        <div class="draggable bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="pet" data-value="Ng·ª±a v·∫±n">ü¶ì Ng·ª±a v·∫±n</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">ƒê·ªì u·ªëng:</h4>
                    <div class="flex flex-wrap gap-2">
                        <div class="draggable bg-brown-100 text-brown-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="drink" data-value="C√† ph√™">‚òï C√† ph√™</div>
                        <div class="draggable bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="drink" data-value="Tr√†">üçµ Tr√†</div>
                        <div class="draggable bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="drink" data-value="S·ªØa">ü•õ S·ªØa</div>
                        <div class="draggable bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="drink" data-value="N∆∞·ªõc cam">üçä N∆∞·ªõc cam</div>
                        <div class="draggable bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="drink" data-value="N∆∞·ªõc">üíß N∆∞·ªõc</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Ngh·ªÅ nghi·ªáp:</h4>
                    <div class="flex flex-wrap gap-2">
                        <div class="draggable bg-brown-100 text-brown-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="job" data-value="Th·ª£ m·ªôc">üî® Th·ª£ m·ªôc</div>
                        <div class="draggable bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="job" data-value="Gi√°o vi√™n">üë®‚Äçüè´ Gi√°o vi√™n</div>
                        <div class="draggable bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="job" data-value="L√†m v∆∞·ªùn">üå± L√†m v∆∞·ªùn</div>
                        <div class="draggable bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="job" data-value="B√°c sƒ©">üë®‚Äç‚öïÔ∏è B√°c sƒ©</div>
                        <div class="draggable bg-pink-100 text-pink-800 px-3 py-1 rounded-full text-sm" draggable="true" data-type="job" data-value="Th·ª£ l√†m b√°nh">üë®‚Äçüç≥ Th·ª£ l√†m b√°nh</div>
                    </div>
                </div>

                <div class="mt-6 flex gap-4">
                    <button id="checkSolution" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-semibold transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>
                        ‚úÖ Ki·ªÉm tra ƒë√°p √°n
                    </button>
                    <button id="resetGame" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                        üîÑ L√†m l·∫°i
                    </button>
                </div>
                <div id="progressInfo" class="mt-4 text-sm text-gray-600 text-center">
                    ƒêi·ªÅn t·∫•t c·∫£ thu·ªôc t√≠nh ƒë·ªÉ ki·ªÉm tra ƒë√°p √°n (0/20)
                </div>
            </div>

            <!-- Clues -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold text-gray-800 mb-4">üìù G·ª£i √Ω</h3>
                <div class="space-y-2 text-sm">
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi Anh s·ªëng trong ng√¥i nh√† m√†u ƒë·ªè</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi T√¢y Ban Nha s·ªü h·ªØu con ch√≥</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ C√† ph√™ ƒë∆∞·ª£c u·ªëng trong ng√¥i nh√† m√†u xanh l√°</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi Ukraine u·ªëng tr√†</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng√¥i nh√† m√†u xanh l√° n·∫±m ngay b√™n ph·∫£i ng√¥i nh√† m√†u tr·∫Øng</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Th·ª£ m·ªôc s·ªü h·ªØu ·ªëc s√™n</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Gi√°o vi√™n s·ªëng trong ng√¥i nh√† m√†u v√†ng</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ S·ªØa ƒë∆∞·ª£c u·ªëng trong ng√¥i nh√† s·ªë 3</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi Na Uy s·ªëng trong ng√¥i nh√† s·ªë 1</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi l√†m v∆∞·ªùn s·ªëng c·∫°nh ng∆∞·ªùi c√≥ con c√°o</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Gi√°o vi√™n s·ªëng c·∫°nh ng√¥i nh√† c√≥ nu√¥i ng·ª±a</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ B√°c sƒ© u·ªëng n∆∞·ªõc cam</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Th·ª£ l√†m b√°nh l√† ng∆∞·ªùi Nh·∫≠t</div>
                    <div class="clue p-3 bg-gray-50 rounded-lg">‚Ä¢ Ng∆∞·ªùi Na Uy s·ªëng c·∫°nh ng√¥i nh√† m√†u xanh d∆∞∆°ng</div>
                </div>

                <div class="mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded">
                    <h4 class="font-bold text-yellow-800 mb-2">üéØ C√¢u h·ªèi:</h4>
                    <p class="text-yellow-700">‚Ä¢ Ai u·ªëng n∆∞·ªõc?</p>
                    <p class="text-yellow-700">‚Ä¢ Ai s·ªü h·ªØu ng·ª±a v·∫±n?</p>
                </div>
            </div>
        </div>

        <!-- Result Modal -->
        <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-lg p-8 max-w-md mx-4">
                <div id="resultContent" class="text-center">
                    <!-- Result content will be inserted here -->
                </div>
                <button id="closeModal" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold w-full transition-colors">
                    ƒê√≥ng
                </button>
            </div>
        </div>
        </div>
    </div>

    <script>
        // Game variables
        let playerName = '';
        let startTime = null;
        let timerInterval = null;
        let usedItems = new Set(); // Track used items

        // Game state - using color as house identifier
        let gameState = {
            "V√†ng": {nationality: null, pet: null, drink: null, job: null},
            "Xanh d∆∞∆°ng": {nationality: null, pet: null, drink: null, job: null},
            "ƒê·ªè": {nationality: null, pet: null, drink: null, job: null},
            "Tr·∫Øng": {nationality: null, pet: null, drink: null, job: null},
            "Xanh l√°": {nationality: null, pet: null, drink: null, job: null}
        };

        // Correct solution - using color as house identifier
        const correctSolution = {
            "V√†ng": {nationality: "Na Uy", pet: "C√°o", drink: "N∆∞·ªõc", job: "Gi√°o vi√™n"},
            "Xanh d∆∞∆°ng": {nationality: "Ukraine", pet: "Ng·ª±a", drink: "Tr√†", job: "L√†m v∆∞·ªùn"},
            "ƒê·ªè": {nationality: "Anh", pet: "·ªêc s√™n", drink: "S·ªØa", job: "Th·ª£ m·ªôc"},
            "Tr·∫Øng": {nationality: "T√¢y Ban Nha", pet: "Ch√≥", drink: "N∆∞·ªõc cam", job: "B√°c sƒ©"},
            "Xanh l√°": {nationality: "Nh·∫≠t", pet: "Ng·ª±a v·∫±n", drink: "C√† ph√™", job: "Th·ª£ l√†m b√°nh"}
        };

        // Login functionality
        const playerNameInput = document.getElementById('playerName');
        const startGameBtn = document.getElementById('startGame');
        const loginScreen = document.getElementById('loginScreen');
        const gameScreen = document.getElementById('gameScreen');
        const playerNameDisplay = document.getElementById('playerNameDisplay');
        const timerDisplay = document.getElementById('timer');

        playerNameInput.addEventListener('input', function() {
            startGameBtn.disabled = this.value.trim().length === 0;
        });

        playerNameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !startGameBtn.disabled) {
                startGameFunction();
            }
        });

        startGameBtn.addEventListener('click', startGameFunction);

        function startGameFunction() {
            playerName = playerNameInput.value.trim();
            if (playerName) {
                playerNameDisplay.textContent = playerName;
                loginScreen.classList.add('hidden');
                gameScreen.classList.remove('hidden');
                startTimer();
            }
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function getElapsedTime() {
            if (startTime) {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            return '00:00';
        }

        // Drag and drop functionality
        let draggedElement = null;

        document.querySelectorAll('.draggable').forEach(item => {
            item.addEventListener('dragstart', function(e) {
                draggedElement = this;
                this.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            });

            item.addEventListener('dragend', function(e) {
                this.classList.remove('dragging');
                draggedElement = null;
            });
        });

        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });

            zone.addEventListener('dragleave', function(e) {
                this.classList.remove('drag-over');
            });

            zone.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                if (draggedElement && draggedElement.dataset.type === this.dataset.type) {
                    // Remove any existing item in this slot
                    const existingItem = this.querySelector('.draggable');
                    if (existingItem) {
                        // Return the existing item to available items
                        const existingValue = existingItem.dataset.value;
                        usedItems.delete(existingValue);
                        existingItem.remove();
                    }

                    // Clone the dragged element
                    const clonedElement = draggedElement.cloneNode(true);
                    clonedElement.classList.remove('dragging');
                    
                    // Add to used items and hide original
                    const itemValue = draggedElement.dataset.value;
                    usedItems.add(itemValue);
                    draggedElement.style.display = 'none';
                    
                    // Add remove functionality
                    clonedElement.addEventListener('click', function() {
                        // Return item to available items
                        usedItems.delete(itemValue);
                        draggedElement.style.display = 'inline-block';
                        this.remove();
                        updateGameState();
                    });

                    this.appendChild(clonedElement);
                    updateGameState();
                }
            });
        });

        function updateGameState() {
            // Reset game state
            for (let house in gameState) {
                for (let type in gameState[house]) {
                    gameState[house][type] = null;
                }
            }

            // Update game state based on current placements
            document.querySelectorAll('.drop-zone').forEach(zone => {
                const item = zone.querySelector('.draggable');
                if (item) {
                    const house = zone.dataset.house;
                    const type = zone.dataset.type;
                    const value = item.dataset.value;
                    gameState[house][type] = value;
                }
            });

            // Update progress and enable/disable check button
            updateProgress();
        }

        function updateProgress() {
            let filledSlots = 0;
            const totalSlots = 20; // 5 houses √ó 4 attributes each

            for (let house in gameState) {
                for (let type in gameState[house]) {
                    if (gameState[house][type] !== null) {
                        filledSlots++;
                    }
                }
            }

            const progressInfo = document.getElementById('progressInfo');
            const checkButton = document.getElementById('checkSolution');
            
            progressInfo.textContent = `ƒêi·ªÅn t·∫•t c·∫£ thu·ªôc t√≠nh ƒë·ªÉ ki·ªÉm tra ƒë√°p √°n (${filledSlots}/${totalSlots})`;
            
            if (filledSlots === totalSlots) {
                checkButton.disabled = false;
                progressInfo.textContent = `ƒê√£ ƒëi·ªÅn ƒë·ªß! Nh·∫•n ki·ªÉm tra ƒë√°p √°n (${filledSlots}/${totalSlots})`;
                progressInfo.classList.add('text-green-600', 'font-semibold');
                progressInfo.classList.remove('text-gray-600');
            } else {
                checkButton.disabled = true;
                progressInfo.classList.remove('text-green-600', 'font-semibold');
                progressInfo.classList.add('text-gray-600');
            }
        }

        function checkSolution() {
            let correct = true;
            let correctCount = 0;
            let totalSlots = 20;

            for (let house in correctSolution) {
                for (let type in correctSolution[house]) {
                    if (gameState[house][type] === correctSolution[house][type]) {
                        correctCount++;
                    } else {
                        correct = false;
                    }
                }
            }

            const modal = document.getElementById('resultModal');
            const content = document.getElementById('resultContent');

            if (correctCount === totalSlots && correct) {
                stopTimer();
                const completionTime = getElapsedTime();
                content.innerHTML = `
                    <div class="text-6xl mb-4">üéâ</div>
                    <h3 class="text-2xl font-bold text-green-600 mb-2">Ch√∫c m·ª´ng ${playerName}!</h3>
                    <p class="text-gray-700 mb-2">B·∫°n ƒë√£ gi·∫£i ƒë√∫ng c√¢u ƒë·ªë Einstein!</p>
                    <p class="text-lg font-semibold text-blue-600 mb-4">‚è±Ô∏è Th·ªùi gian ho√†n th√†nh: ${completionTime}</p>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="font-semibold text-green-800">ƒê√°p √°n:</p>
                        <p class="text-green-700">‚Ä¢ Ng∆∞·ªùi Na Uy (nh√† v√†ng) u·ªëng n∆∞·ªõc</p>
                        <p class="text-green-700">‚Ä¢ Ng∆∞·ªùi Nh·∫≠t (nh√† xanh l√°) s·ªü h·ªØu ng·ª±a v·∫±n</p>
                    </div>
                `;
            } else {
                content.innerHTML = `
                    <div class="text-6xl mb-4">ü§î</div>
                    <h3 class="text-2xl font-bold text-orange-600 mb-2">Ch∆∞a ƒë√∫ng!</h3>
                    <p class="text-gray-700 mb-2">B·∫°n ƒë√£ ƒëi·ªÅn ƒë√∫ng ${correctCount}/${totalSlots} thu·ªôc t√≠nh.</p>
                    <p class="text-gray-600">H√£y ki·ªÉm tra l·∫°i c√°c g·ª£i √Ω v√† th·ª≠ l·∫°i!</p>
                `;
            }

            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }



        function resetGame() {
            document.querySelectorAll('.drop-zone .draggable').forEach(item => item.remove());
            // Show all hidden items
            document.querySelectorAll('.draggable[style*="display: none"]').forEach(item => {
                item.style.display = 'inline-block';
            });
            usedItems.clear();
            updateGameState();
        }

        // Event listeners
        document.getElementById('checkSolution').addEventListener('click', checkSolution);
        document.getElementById('resetGame').addEventListener('click', resetGame);
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('resultModal').classList.add('hidden');
            document.getElementById('resultModal').classList.remove('flex');
        });

        // Close modal when clicking outside
        document.getElementById('resultModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
                this.classList.remove('flex');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9716a2854325c9c6',t:'MTc1NTU3NDg4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
